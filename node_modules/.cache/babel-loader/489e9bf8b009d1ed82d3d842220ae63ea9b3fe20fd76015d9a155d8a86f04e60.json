{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{useLocation}from'react-router-dom';import{Link}from'react-router-dom';import{Helmet}from'react-helmet-async';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function ListeArtisans(){const[artisans,setArtisans]=useState([]);const[loading,setLoading]=useState(true);const location=useLocation();// Extraction des paramètres de recherche\nconst queryParams=new URLSearchParams(location.search);const nom=queryParams.get('nom');const categorie=queryParams.get('categorie');// Fonction pour obtenir un titre dynamique basé sur la catégorie ou le nom\nconst getTitreCategorie=()=>{if(categorie){switch(categorie){case'batiment':return'Bâtiment';case'services':return'Services';case'fabrication':return'Fabrication';case'alimentation':return'Alimentation';default:return'Liste des Artisans';}}else if(nom){return`Résultats pour \"${nom}\"`;}else{return'Tous les Artisans';}};// Effect pour récupérer les artisans en fonction des paramètres 'nom' ou 'categorie'\nuseEffect(()=>{const fetchArtisans=async()=>{try{let url='http://localhost:3001/api/artisans';// Modifie l'URL en fonction des paramètres de recherche\nif(nom){url+=`/search?nom=${encodeURIComponent(nom)}`;}else if(categorie){url+=`/categorie/${encodeURIComponent(categorie)}`;}const response=await axios.get(url);setArtisans(response.data);// Met à jour l'état avec les artisans récupérés\n}catch(err){console.error('Erreur lors de la récupération des artisans:',err);setArtisans([]);// Si erreur, vide le tableau des artisans\n}finally{setLoading(false);// Indique que le chargement est terminé\n}};fetchArtisans();},[nom,categorie]);// Dépendances : mise à jour lorsque 'nom' ou 'categorie' change\n// Fonction pour afficher les étoiles selon la note de l'artisan\nconst renderStars=note=>{const stars=[];for(let i=1;i<=5;i++){stars.push(/*#__PURE__*/_jsx(\"span\",{className:i<=note?'star filled':'star',children:\"\\u2605\"},i));}return/*#__PURE__*/_jsxs(_Fragment,{children:[stars,/*#__PURE__*/_jsxs(\"span\",{className:\"sr-only\",children:[\" \",note,\"/5\"]})]});};// Affichage si les données sont en train de se charger\nif(loading)return/*#__PURE__*/_jsx(\"p\",{className:\"loading\",children:\"Chargement...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"artisans-container\",children:[/*#__PURE__*/_jsxs(Helmet,{children:[/*#__PURE__*/_jsx(\"title\",{children:\"Liste des artisans\"}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:\"Explorez notre s\\xE9lection d'artisans professionnels dans diverses cat\\xE9gories.  Que vous ayez besoin d'un plombier, \\xE9lectricien ou menuisier, trouvez l'expert qu'il vous faut pr\\xE8s de chez vous.\"})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"title\",children:getTitreCategorie()}),artisans.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-result\",children:\"Aucun artisan trouv\\xE9\"}):/*#__PURE__*/_jsx(\"div\",{className:\"card-grid\",children:artisans.map(artisan=>{var _artisan$specialite;return/*#__PURE__*/_jsxs(Link,{to:`/artisan/${artisan.id}`,className:\"artisan-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:artisan.nom}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Sp\\xE9cialit\\xE9 :\"}),\" \",((_artisan$specialite=artisan.specialite)===null||_artisan$specialite===void 0?void 0:_artisan$specialite.nom)||'Non renseignée']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Localisation :\"}),\" \",artisan.ville||'Non précisée']}),/*#__PURE__*/_jsx(\"p\",{className:\"stars\",children:renderStars(artisan.note||0)})]},artisan.id);})})]});}export default ListeArtisans;","map":{"version":3,"names":["React","useEffect","useState","axios","useLocation","Link","Helmet","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ListeArtisans","artisans","setArtisans","loading","setLoading","location","queryParams","URLSearchParams","search","nom","get","categorie","getTitreCategorie","fetchArtisans","url","encodeURIComponent","response","data","err","console","error","renderStars","note","stars","i","push","className","children","name","content","length","map","artisan","_artisan$specialite","to","id","specialite","ville"],"sources":["/Users/utilisateur/Desktop/En_cours/devoir/miradji_ladhidhou_devoir_trouve_ton_artisan/frontend/src/pages/ListeArtisans.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useLocation } from 'react-router-dom';\nimport { Link } from 'react-router-dom';\nimport { Helmet } from 'react-helmet-async';\n\nfunction ListeArtisans() {\n  const [artisans, setArtisans] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const location = useLocation();\n\n  // Extraction des paramètres de recherche\n  const queryParams = new URLSearchParams(location.search);\n  const nom = queryParams.get('nom');\n  const categorie = queryParams.get('categorie');\n\n  // Fonction pour obtenir un titre dynamique basé sur la catégorie ou le nom\n  const getTitreCategorie = () => {\n    if (categorie) {\n      switch (categorie) {\n        case 'batiment':\n          return 'Bâtiment';\n        case 'services':\n          return 'Services';\n        case 'fabrication':\n          return 'Fabrication';\n        case 'alimentation':\n          return 'Alimentation';\n        default:\n          return 'Liste des Artisans';\n      }\n    } else if (nom) {\n      return `Résultats pour \"${nom}\"`;\n    } else {\n      return 'Tous les Artisans';\n    }\n  };\n\n  // Effect pour récupérer les artisans en fonction des paramètres 'nom' ou 'categorie'\n  useEffect(() => {\n    const fetchArtisans = async () => {\n      try {\n        let url = 'http://localhost:3001/api/artisans';\n\n        // Modifie l'URL en fonction des paramètres de recherche\n        if (nom) {\n          url += `/search?nom=${encodeURIComponent(nom)}`;\n        } else if (categorie) {\n          url += `/categorie/${encodeURIComponent(categorie)}`;\n        }\n\n        const response = await axios.get(url);\n        setArtisans(response.data);  // Met à jour l'état avec les artisans récupérés\n      } catch (err) {\n        console.error('Erreur lors de la récupération des artisans:', err);\n        setArtisans([]);  // Si erreur, vide le tableau des artisans\n      } finally {\n        setLoading(false);  // Indique que le chargement est terminé\n      }\n    };\n\n    fetchArtisans();\n  }, [nom, categorie]);  // Dépendances : mise à jour lorsque 'nom' ou 'categorie' change\n\n  // Fonction pour afficher les étoiles selon la note de l'artisan\n  const renderStars = (note) => {\n    const stars = [];\n    for (let i = 1; i <= 5; i++) {\n      stars.push(\n        <span key={i} className={i <= note ? 'star filled' : 'star'}>★</span>\n      );\n    }\n    return (\n      <>\n        {stars}\n        <span className=\"sr-only\"> {note}/5</span>\n      </>\n    );\n  };\n\n  // Affichage si les données sont en train de se charger\n  if (loading) return <p className=\"loading\">Chargement...</p>;\n\n  return (\n    <div className=\"artisans-container\">\n\n      <Helmet>\n        <title>Liste des artisans</title>\n        <meta name=\"description\" content=\"Explorez notre sélection d'artisans professionnels dans diverses catégories. \n        Que vous ayez besoin d'un plombier, électricien ou menuisier, trouvez l'expert qu'il vous faut près de chez vous.\" />\n      </Helmet>\n\n      <h2 className=\"title\">{getTitreCategorie()}</h2>\n      \n      {/* Si aucun artisan n'est trouvé, affiche un message */}\n      {artisans.length === 0 ? (\n        <p className=\"no-result\">Aucun artisan trouvé</p>\n      ) : (\n        <div className=\"card-grid\">\n          {/* Affichage de chaque artisan */}\n          {artisans.map((artisan) => (\n            <Link to={`/artisan/${artisan.id}`} key={artisan.id} className=\"artisan-card\">\n              <h3>{artisan.nom}</h3>\n              <p><strong>Spécialité :</strong> {artisan.specialite?.nom || 'Non renseignée'}</p>\n              <p><strong>Localisation :</strong> {artisan.ville || 'Non précisée'}</p>\n              <p className=\"stars\">{renderStars(artisan.note || 0)}</p>\n            </Link>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default ListeArtisans;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,IAAI,KAAQ,kBAAkB,CACvC,OAASC,MAAM,KAAQ,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE5C,QAAS,CAAAC,aAAaA,CAAA,CAAG,CACvB,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACc,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAgB,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAE9B;AACA,KAAM,CAAAe,WAAW,CAAG,GAAI,CAAAC,eAAe,CAACF,QAAQ,CAACG,MAAM,CAAC,CACxD,KAAM,CAAAC,GAAG,CAAGH,WAAW,CAACI,GAAG,CAAC,KAAK,CAAC,CAClC,KAAM,CAAAC,SAAS,CAAGL,WAAW,CAACI,GAAG,CAAC,WAAW,CAAC,CAE9C;AACA,KAAM,CAAAE,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,GAAID,SAAS,CAAE,CACb,OAAQA,SAAS,EACf,IAAK,UAAU,CACb,MAAO,UAAU,CACnB,IAAK,UAAU,CACb,MAAO,UAAU,CACnB,IAAK,aAAa,CAChB,MAAO,aAAa,CACtB,IAAK,cAAc,CACjB,MAAO,cAAc,CACvB,QACE,MAAO,oBAAoB,CAC/B,CACF,CAAC,IAAM,IAAIF,GAAG,CAAE,CACd,MAAO,mBAAmBA,GAAG,GAAG,CAClC,CAAC,IAAM,CACL,MAAO,mBAAmB,CAC5B,CACF,CAAC,CAED;AACArB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAyB,aAAa,CAAG,KAAAA,CAAA,GAAY,CAChC,GAAI,CACF,GAAI,CAAAC,GAAG,CAAG,oCAAoC,CAE9C;AACA,GAAIL,GAAG,CAAE,CACPK,GAAG,EAAI,eAAeC,kBAAkB,CAACN,GAAG,CAAC,EAAE,CACjD,CAAC,IAAM,IAAIE,SAAS,CAAE,CACpBG,GAAG,EAAI,cAAcC,kBAAkB,CAACJ,SAAS,CAAC,EAAE,CACtD,CAEA,KAAM,CAAAK,QAAQ,CAAG,KAAM,CAAA1B,KAAK,CAACoB,GAAG,CAACI,GAAG,CAAC,CACrCZ,WAAW,CAACc,QAAQ,CAACC,IAAI,CAAC,CAAG;AAC/B,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,8CAA8C,CAAEF,GAAG,CAAC,CAClEhB,WAAW,CAAC,EAAE,CAAC,CAAG;AACpB,CAAC,OAAS,CACRE,UAAU,CAAC,KAAK,CAAC,CAAG;AACtB,CACF,CAAC,CAEDS,aAAa,CAAC,CAAC,CACjB,CAAC,CAAE,CAACJ,GAAG,CAAEE,SAAS,CAAC,CAAC,CAAG;AAEvB;AACA,KAAM,CAAAU,WAAW,CAAIC,IAAI,EAAK,CAC5B,KAAM,CAAAC,KAAK,CAAG,EAAE,CAChB,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,EAAI,CAAC,CAAEA,CAAC,EAAE,CAAE,CAC3BD,KAAK,CAACE,IAAI,cACR9B,IAAA,SAAc+B,SAAS,CAAEF,CAAC,EAAIF,IAAI,CAAG,aAAa,CAAG,MAAO,CAAAK,QAAA,CAAC,QAAC,EAAnDH,CAAyD,CACtE,CAAC,CACH,CACA,mBACE3B,KAAA,CAAAE,SAAA,EAAA4B,QAAA,EACGJ,KAAK,cACN1B,KAAA,SAAM6B,SAAS,CAAC,SAAS,CAAAC,QAAA,EAAC,GAAC,CAACL,IAAI,CAAC,IAAE,EAAM,CAAC,EAC1C,CAAC,CAEP,CAAC,CAED;AACA,GAAInB,OAAO,CAAE,mBAAOR,IAAA,MAAG+B,SAAS,CAAC,SAAS,CAAAC,QAAA,CAAC,eAAa,CAAG,CAAC,CAE5D,mBACE9B,KAAA,QAAK6B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eAEjC9B,KAAA,CAACJ,MAAM,EAAAkC,QAAA,eACLhC,IAAA,UAAAgC,QAAA,CAAO,oBAAkB,CAAO,CAAC,cACjChC,IAAA,SAAMiC,IAAI,CAAC,aAAa,CAACC,OAAO,CAAC,6MACiF,CAAE,CAAC,EAC/G,CAAC,cAETlC,IAAA,OAAI+B,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEf,iBAAiB,CAAC,CAAC,CAAK,CAAC,CAG/CX,QAAQ,CAAC6B,MAAM,GAAK,CAAC,cACpBnC,IAAA,MAAG+B,SAAS,CAAC,WAAW,CAAAC,QAAA,CAAC,yBAAoB,CAAG,CAAC,cAEjDhC,IAAA,QAAK+B,SAAS,CAAC,WAAW,CAAAC,QAAA,CAEvB1B,QAAQ,CAAC8B,GAAG,CAAEC,OAAO,OAAAC,mBAAA,oBACpBpC,KAAA,CAACL,IAAI,EAAC0C,EAAE,CAAE,YAAYF,OAAO,CAACG,EAAE,EAAG,CAAkBT,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3EhC,IAAA,OAAAgC,QAAA,CAAKK,OAAO,CAACvB,GAAG,CAAK,CAAC,cACtBZ,KAAA,MAAA8B,QAAA,eAAGhC,IAAA,WAAAgC,QAAA,CAAQ,oBAAY,CAAQ,CAAC,IAAC,CAAC,EAAAM,mBAAA,CAAAD,OAAO,CAACI,UAAU,UAAAH,mBAAA,iBAAlBA,mBAAA,CAAoBxB,GAAG,GAAI,gBAAgB,EAAI,CAAC,cAClFZ,KAAA,MAAA8B,QAAA,eAAGhC,IAAA,WAAAgC,QAAA,CAAQ,gBAAc,CAAQ,CAAC,IAAC,CAACK,OAAO,CAACK,KAAK,EAAI,cAAc,EAAI,CAAC,cACxE1C,IAAA,MAAG+B,SAAS,CAAC,OAAO,CAAAC,QAAA,CAAEN,WAAW,CAACW,OAAO,CAACV,IAAI,EAAI,CAAC,CAAC,CAAI,CAAC,GAJlBU,OAAO,CAACG,EAK3C,CAAC,EACR,CAAC,CACC,CACN,EACE,CAAC,CAEV,CAEA,cAAe,CAAAnC,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}